!function(){"use strict";var e,t,l=tinymce.util.Tools.resolve("tinymce.PluginManager");let o=(e,t,l)=>{var o;return!!l(e,t.prototype)||(null===(o=e.constructor)||void 0===o?void 0:o.name)===t.name},r=e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&o(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},n=e=>t=>r(t)===e,a=e=>t=>typeof t===e,s=n("string"),i=n("array"),c=a("boolean"),m=(e=void 0,t=>e===t),d=e=>null==e,u=e=>!d(e),b=a("function"),p=a("number"),g=()=>{},h=(e,t)=>l=>e(t(l)),f=e=>()=>e,y=e=>e,w=(e,t)=>e===t;function S(e,...t){return(...l)=>{let o=t.concat(l);return e.apply(null,o)}}let C=e=>{e()},v=f(!1),T=f(!0);class ${constructor(e,t){this.tag=e,this.value=t}static some(e){return new $(!0,e)}static none(){return $.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?$.some(e(this.value)):$.none()}bind(e){return this.tag?e(this.value):$.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:$.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return u(e)?$.some(e):$.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}$.singletonNone=new $(!1);let x=Object.keys,_=Object.hasOwnProperty,A=(e,t)=>{let l=x(e);for(let o=0,r=l.length;o<r;o++){let n=l[o],a=e[n];t(a,n)}},R=e=>(t,l)=>{e[l]=t},O=(e,t,l,o)=>{A(e,(e,r)=>{(t(e,r)?l:o)(e,r)})},D=(e,t)=>{let l={};return O(e,t,R(l),g),l},I=(e,t)=>{let l=[];return A(e,(e,o)=>{l.push(t(e,o))}),l},N=e=>I(e,y),M=e=>x(e).length,P=(e,t)=>k(e,t)?$.from(e[t]):$.none(),k=(e,t)=>_.call(e,t),B=(e,t)=>k(e,t)&&void 0!==e[t]&&null!==e[t],E=e=>{for(let t in e)if(_.call(e,t))return!1;return!0},q=Array.prototype.indexOf,F=Array.prototype.push,L=(e,t)=>q.call(e,t),j=(e,t)=>L(e,t)>-1,H=(e,t)=>{for(let l=0,o=e.length;l<o;l++){let r=e[l];if(t(r,l))return!0}return!1},V=(e,t)=>{let l=[];for(let o=0;o<e;o++)l.push(t(o));return l},z=(e,t)=>{let l=e.length,o=Array(l);for(let r=0;r<l;r++){let n=e[r];o[r]=t(n,r)}return o},W=(e,t)=>{for(let l=0,o=e.length;l<o;l++){let r=e[l];t(r,l)}},U=(e,t)=>{for(let l=e.length-1;l>=0;l--){let o=e[l];t(o,l)}},G=(e,t)=>{let l=[],o=[];for(let r=0,n=e.length;r<n;r++){let a=e[r],s=t(a,r)?l:o;s.push(a)}return{pass:l,fail:o}},K=(e,t)=>{let l=[];for(let o=0,r=e.length;o<r;o++){let n=e[o];t(n,o)&&l.push(n)}return l},J=(e,t,l)=>(U(e,(e,o)=>{l=t(l,e,o)}),l),Q=(e,t,l)=>(W(e,(e,o)=>{l=t(l,e,o)}),l),X=(e,t,l)=>{for(let o=0,r=e.length;o<r;o++){let n=e[o];if(t(n,o))return $.some(n);if(l(n,o))break}return $.none()},Y=(e,t)=>X(e,t,v),Z=e=>{let t=[];for(let l=0,o=e.length;l<o;++l){if(!i(e[l]))throw Error("Arr.flatten item "+l+" was not an array, input: "+e);F.apply(t,e[l])}return t},ee=(e,t)=>Z(z(e,t)),et=(e,t)=>{for(let l=0,o=e.length;l<o;++l){let r=e[l];if(!0!==t(r,l))return!1}return!0},el=(e,t)=>{let l={};for(let o=0,r=e.length;o<r;o++){let n=e[o];l[String(n)]=t(n,o)}return l},eo=(e,t)=>t>=0&&t<e.length?$.some(e[t]):$.none(),er=e=>eo(e,0),en=e=>eo(e,e.length-1),ea=(e,t)=>{for(let l=0;l<e.length;l++){let o=t(e[l],l);if(o.isSome())return o}return $.none()},es=(e,t)=>{let l=(t||document).createElement("div");if(l.innerHTML=e,!l.hasChildNodes()||l.childNodes.length>1){let o="HTML does not have a single root node";throw console.error(o,e),Error(o)}return em(l.childNodes[0])},ei=(e,t)=>{let l=(t||document).createElement(e);return em(l)},ec=(e,t)=>{let l=(t||document).createTextNode(e);return em(l)},em=e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}},ed=(e,t,l)=>$.from(e.dom.elementFromPoint(t,l)).map(em),eu={fromHtml:es,fromTag:ei,fromText:ec,fromDom:em,fromPoint:ed},eb=(e,t)=>{let l=e.dom;if(1!==l.nodeType)return!1;{let o=l;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);else if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);else throw Error("Browser lacks native selectors")}},ep=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,eg=(e,t)=>{let l=void 0===t?document:t.dom;return ep(l)?[]:z(l.querySelectorAll(e),eu.fromDom)},eh=(e,t)=>{let l=void 0===t?document:t.dom;return ep(l)?$.none():$.from(l.querySelector(e)).map(eu.fromDom)},ef=(e,t)=>e.dom===t.dom,ey=eb;"undefined"!=typeof window?window:Function("return this;")();let ew=e=>{let t=e.dom.nodeName;return t.toLowerCase()},eS=e=>e.dom.nodeType,eC=e=>t=>eS(t)===e,ev=e=>8===eS(e)||"#comment"===ew(e),eT=eC(1),e$=eC(3),ex=eC(9),e_=eC(11),eA=e=>t=>eT(t)&&ew(t)===e,eR=e=>eu.fromDom(e.dom.ownerDocument),e8=e=>ex(e)?e:eR(e),eO=e=>$.from(e.dom.parentNode).map(eu.fromDom),eD=(e,t)=>{let l=b(t)?t:v,o=e.dom,r=[];for(;null!==o.parentNode&&void 0!==o.parentNode;){let n=o.parentNode,a=eu.fromDom(n);if(r.push(a),!0===l(a))break;o=n}return r},eI=e=>$.from(e.dom.previousSibling).map(eu.fromDom),eN=e=>$.from(e.dom.nextSibling).map(eu.fromDom),eM=e=>z(e.dom.childNodes,eu.fromDom),eP=(e,t)=>{let l=e.dom.childNodes;return $.from(l[t]).map(eu.fromDom)},ek=e=>eP(e,0),eB=e=>e_(e)&&u(e.dom.host),eE=b(Element.prototype.attachShadow)&&b(Node.prototype.getRootNode),eq=eE?e=>eu.fromDom(e.dom.getRootNode()):e8,eF=e=>{let t=eq(e);return eB(t)?$.some(t):$.none()},eL=e=>eu.fromDom(e.dom.host),ej=e=>{let t=e$(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;let l=t.ownerDocument;return eF(eu.fromDom(t)).fold(()=>l.body.contains(t),h(ej,eL))};var eH=(e,t,l,o,r)=>e(l,o)?$.some(l):b(r)&&r(l)?$.none():t(l,o,r);let eV=(e,t,l)=>{let o=e.dom,r=b(l)?l:v;for(;o.parentNode;){o=o.parentNode;let n=eu.fromDom(o);if(t(n))return $.some(n);if(r(n))break}return $.none()},e9=(e,t,l)=>{let o=(e,t)=>t(e);return eH(o,eV,e,t,l)},e0=(e,t)=>{let l=e=>t(eu.fromDom(e)),o=Y(e.dom.childNodes,l);return o.map(eu.fromDom)},ez=(e,t,l)=>eV(e,e=>eb(e,t),l),eW=(e,t)=>e0(e,e=>eb(e,t)),eU=(e,t)=>eh(t,e),e1=(e,t,l)=>{let o=(e,t)=>eb(e,t);return eH(o,ez,e,t,l)},eG=e=>e1(e,"[contenteditable]"),e2=(e,t=!1)=>ej(e)?e.dom.isContentEditable:eG(e).fold(f(t),e=>"true"===e3(e)),e3=e=>e.dom.contentEditable,e4=e=>e.nodeName.toLowerCase(),e7=e=>eu.fromDom(e.getBody()),eK=e=>t=>ef(t,e7(e)),e6=e=>e?e.replace(/px$/,""):"",eJ=e=>/^\d+(\.\d+)?$/.test(e)?e+"px":e,eQ=e=>eu.fromDom(e.selection.getStart()),eX=e=>eu.fromDom(e.selection.getEnd()),eY=e=>e9(e,eA("table")).forall(e2),eZ=(e,t)=>K(eM(e),t),e5=(e,t)=>{let l=[];return W(eM(e),e=>{t(e)&&(l=l.concat([e])),l=l.concat(e5(e,t))}),l},te=(e,t)=>eZ(e,e=>eb(e,t)),tt=(e,t)=>eg(t,e),tl=(e,t,l)=>{if(s(l)||c(l)||p(l))e.setAttribute(t,l+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",l,":: Element ",e),Error("Attribute value was not simple")},to=(e,t,l)=>{tl(e.dom,t,l)},tr=(e,t)=>{let l=e.dom;A(t,(e,t)=>{tl(l,t,e)})},tn=(e,t)=>{let l=e.dom.getAttribute(t);return null===l?void 0:l},ta=(e,t)=>$.from(tn(e,t)),ts=(e,t)=>{e.dom.removeAttribute(t)},ti=e=>Q(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),tc=(e,t,l=w)=>e.exists(e=>l(e,t)),tm=e=>{let t=[],l=e=>{t.push(e)};for(let o=0;o<e.length;o++)e[o].each(l);return t},td=(e,t,l)=>e.isSome()&&t.isSome()?$.some(l(e.getOrDie(),t.getOrDie())):$.none(),tu=e=>e.bind(y),tb=(e,t)=>e?$.some(t):$.none(),tp=(e,t)=>e.substring(t),tg=(e,t,l)=>""===t||e.length>=t.length&&e.substr(l,l+t.length)===t,th=(e,t)=>tf(e,t)?tp(e,t.length):e,tf=(e,t)=>tg(e,t,0),ty=e=>e.replace(/^\s+|\s+$/g,""),tw=e=>e.length>0,tS=e=>!tw(e),tC=(e,t=10)=>{let l=parseInt(e,t);return isNaN(l)?$.none():$.some(l)},tv=e=>{let t=parseFloat(e);return isNaN(t)?$.none():$.some(t)},tT=e=>void 0!==e.style&&b(e.style.getPropertyValue),t$=(e,t,l)=>{if(!s(l))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",l,":: Element ",e),Error("CSS value must be a string: "+l);tT(e)&&e.style.setProperty(t,l)},tx=(e,t)=>{tT(e)&&e.style.removeProperty(t)},t_=(e,t,l)=>{let o=e.dom;t$(o,t,l)},tA=(e,t)=>{let l=e.dom,o=window.getComputedStyle(l),r=o.getPropertyValue(t);return""!==r||ej(e)?r:tR(l,t)},tR=(e,t)=>tT(e)?e.style.getPropertyValue(t):"",t8=(e,t)=>{let l=e.dom,o=tR(l,t);return $.from(o).filter(e=>e.length>0)},tO=(e,t)=>{let l=e.dom;tx(l,t),tc(ta(e,"style").map(ty),"")&&ts(e,"style")},tD=(e,t,l=0)=>ta(e,t).map(e=>parseInt(e,10)).getOr(l),tI=(e,t)=>tN(e,t,T),tN=(e,t,l)=>ee(eM(e),e=>eb(e,t)?l(e)?[e]:[]:tN(e,t,l)),tM=["tfoot","thead","tbody","colgroup"],tP=e=>j(tM,e),tk=(e,t)=>({rows:e,columns:t}),tB=(e,t,l)=>({element:e,rowspan:t,colspan:l}),tE=(e,t,l,o,r,n)=>({element:e,rowspan:t,colspan:l,row:o,column:r,isLocked:n}),tq=(e,t,l)=>({element:e,cells:t,section:l}),tF=(e,t,l,o)=>({startRow:e,startCol:t,finishRow:l,finishCol:o}),tL=(e,t,l)=>({element:e,colspan:t,column:l}),tj=(e,t)=>({element:e,columns:t}),tH=(e,t,l=v)=>{if(l(t))return $.none();if(j(e,ew(t)))return $.some(t);let o=e=>eb(e,"table")||l(e);return ez(t,e.join(","),o)},tV=(e,t)=>tH(["td","th"],e,t),t9=e=>tI(e,"th,td"),t0=e=>eb(e,"colgroup")?te(e,"col"):ee(tU(e),e=>te(e,"col")),tz=(e,t)=>e1(e,"table",t),tW=e=>tI(e,"tr"),tU=e=>tz(e).fold(f([]),e=>te(e,"colgroup")),t1=(e,t)=>z(e,e=>{if("colgroup"===ew(e)){let l=z(t0(e),e=>{let t=tD(e,"span",1);return tB(e,1,t)});return tq(e,l,"colgroup")}{let o=z(t9(e),e=>{let t=tD(e,"rowspan",1),l=tD(e,"colspan",1);return tB(e,t,l)});return tq(e,o,t(e))}}),tG=e=>eO(e).map(e=>{let t=ew(e);return tP(t)?t:"tbody"}).getOr("tbody"),t2=e=>{let t=tW(e),l=tU(e);return t1([...l,...t],tG)},t3=e=>ta(e,"data-snooker-locked-cols").bind(e=>$.from(e.match(/\d+/g))).map(e=>el(e,T)),t4=(e,t)=>e+","+t,t7=(e,t,l)=>$.from(e.access[t4(t,l)]),tK=(e,t,l)=>{let o=t6(e,e=>l(t,e.element));return o.length>0?$.some(o[0]):$.none()},t6=(e,t)=>{let l=ee(e.all,e=>e.cells);return K(l,t)},tJ=e=>{let t={},l=0;return W(e.cells,e=>{let o=e.colspan;V(o,r=>{let n=l+r;t[n]=tL(e.element,o,n)}),l+=o}),t},tQ=e=>{let t={},l=[],o=er(e).map(e=>e.element).bind(tz),r=o.bind(t3).getOr({}),n=0,a=0,s=0,{pass:i,fail:c}=G(e,e=>"colgroup"===e.section);W(c,e=>{let o=[];W(e.cells,e=>{let l=0;for(;void 0!==t[t4(s,l)];)l++;let n=B(r,l.toString()),i=tE(e.element,e.rowspan,e.colspan,s,l,n);for(let c=0;c<e.colspan;c++)for(let m=0;m<e.rowspan;m++){let d=s+m,u=l+c,b=t4(d,u);t[b]=i,a=Math.max(a,u+1)}o.push(i)}),n++,l.push(tq(e.element,o,e.section)),s++});let{columns:m,colgroups:d}=en(i).map(e=>{let t=tJ(e),l=tj(e.element,N(t));return{colgroups:[l],columns:t}}).getOrThunk(()=>({colgroups:[],columns:{}})),u=tk(n,a);return{grid:u,access:t,all:l,columns:m,colgroups:d}},tX=e=>{let t=t2(e);return tQ(t)},tY=e=>ee(e.all,e=>e.cells),tZ=e=>N(e.columns),t5=(e,t)=>$.from(e.columns[t]),le={fromTable:tX,generate:tQ,getAt:t7,findItem:tK,filterItems:t6,justCells:tY,justColumns:tZ,hasColumns:e=>x(e.columns).length>0,getColumnAt:t5};var lt=tinymce.util.Tools.resolve("tinymce.util.Tools");let ll=(e,t,l)=>{let o=e.select("td,th",t),r;for(let n=0;n<o.length;n++){let a=e.getStyle(o[n],l);if(m(r)&&(r=a),r!==a)return""}return r},lo=(e,t,l)=>{lt.each("left center right".split(" "),o=>{o!==l&&e.formatter.remove("align"+o,{},t)}),l&&e.formatter.apply("align"+l,{},t)},lr=(e,t,l)=>{lt.each("top middle bottom".split(" "),o=>{o!==l&&e.formatter.remove("valign"+o,{},t)}),l&&e.formatter.apply("valign"+l,{},t)},ln=(e,t,l)=>{e.dispatch("TableModified",{...l,table:t})},la=(e,t)=>tv(e).getOr(t),ls=(e,t,l)=>la(tA(e,t),l),li=(e,t,l,o)=>{let r=ls(e,`padding-${l}`,0),n=ls(e,`padding-${o}`,0),a=ls(e,`border-${l}-width`,0),s=ls(e,`border-${o}-width`,0);return t-r-n-a-s},lc=(e,t)=>{let l=e.dom,o=l.getBoundingClientRect().width||l.offsetWidth;return"border-box"===t?o:li(e,o,"left","right")},lm=e=>lc(e,"content-box"),ld=lm;var lu=tinymce.util.Tools.resolve("tinymce.Env");let lb=V(5,e=>{let t=`${e+1}px`;return{title:t,value:t}}),lp=z(["Solid","Dotted","Dashed","Double","Groove","Ridge","Inset","Outset","None","Hidden",],e=>({title:e,value:e.toLowerCase()})),lg="100%",lh=e=>{var t;let l=e.dom,o=null!==(t=l.getParent(e.selection.getStart(),l.isBlock))&&void 0!==t?t:e.getBody();return ld(eu.fromDom(o))+"px"},lf=(e,t)=>lB(e)||!l8(e)?t:lk(e)?{...t,width:lh(e)}:{...t,width:lg},ly=(e,t)=>lB(e)||l8(e)?t:lk(e)?{...t,width:lh(e)}:{...t,width:lg},lw=e=>t=>t.options.get(e),lS=e=>{let t=e.options.register;t("table_border_widths",{processor:"object[]",default:lb}),t("table_border_styles",{processor:"object[]",default:lp}),t("table_cell_advtab",{processor:"boolean",default:!0}),t("table_row_advtab",{processor:"boolean",default:!0}),t("table_advtab",{processor:"boolean",default:!0}),t("table_appearance_options",{processor:"boolean",default:!0}),t("table_grid",{processor:"boolean",default:!lu.deviceType.isTouch()}),t("table_cell_class_list",{processor:"object[]",default:[]}),t("table_row_class_list",{processor:"object[]",default:[]}),t("table_class_list",{processor:"object[]",default:[]}),t("table_toolbar",{processor:"string",default:"tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol"}),t("table_background_color_map",{processor:"object[]",default:[]}),t("table_border_color_map",{processor:"object[]",default:[]})},lC=lw("table_sizing_mode"),lv=lw("table_border_widths"),lT=lw("table_border_styles"),l$=lw("table_cell_advtab"),lx=lw("table_row_advtab"),l_=lw("table_advtab"),lA=lw("table_appearance_options"),lR=lw("table_grid"),l8=lw("table_style_by_css"),lO=lw("table_cell_class_list"),lD=lw("table_row_class_list"),lI=lw("table_class_list"),lN=lw("table_toolbar"),lM=lw("table_background_color_map"),lP=lw("table_border_color_map"),lk=e=>"fixed"===lC(e),lB=e=>"responsive"===lC(e),lE=e=>{let t=e.options,l=t.get("table_default_styles");return t.isSet("table_default_styles")?l:lf(e,l)},lq=e=>{let t=e.options,l=t.get("table_default_attributes");return t.isSet("table_default_attributes")?l:ly(e,l)},lF=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,lL=(e,t)=>{let l=!0,o=S(lF,t);for(let r=t.startRow;r<=t.finishRow;r++)for(let n=t.startCol;n<=t.finishCol;n++)l=l&&le.getAt(e,r,n).exists(o);return l?$.some(t):$.none()},lj=(e,t)=>tF(Math.min(e.row,t.row),Math.min(e.column,t.column),Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),Math.max(e.column+e.colspan-1,t.column+t.colspan-1)),lH=(e,t,l)=>{let o=le.findItem(e,t,ef),r=le.findItem(e,l,ef);return o.bind(e=>r.map(t=>lj(e,t)))},lV=(e,t,l)=>lH(e,t,l).bind(t=>lL(e,t)),l9=(e,t,l)=>{let o=l0(e);return lV(o,t,l)},l0=le.fromTable,lz=(e,t)=>{let l=eO(e);l.each(l=>{l.dom.insertBefore(t.dom,e.dom)})},lW=(e,t)=>{let l=eN(e);l.fold(()=>{let l=eO(e);l.each(e=>{l1(e,t)})},e=>{lz(e,t)})},lU=(e,t)=>{let l=ek(e);l.fold(()=>{l1(e,t)},l=>{e.dom.insertBefore(t.dom,l.dom)})},l1=(e,t)=>{e.dom.appendChild(t.dom)},lG=(e,t)=>{lz(e,t),l1(t,e)},l2=(e,t)=>{W(t,(l,o)=>{let r=0===o?e:t[o-1];lW(r,l)})},l3=(e,t)=>{W(t,t=>{l1(e,t)})},l4=e=>{let t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},l7=e=>{let t=eM(e);t.length>0&&l2(e,t),l4(e)},lK=((e,t)=>{let l=l=>{if(!e(l))throw Error("Can only get "+t+" value of a "+t+" node");return o(l).getOr("")},o=t=>e(t)?$.from(t.dom.nodeValue):$.none(),r=(l,o)=>{if(!e(l))throw Error("Can only set raw "+t+" value of a "+t+" node");l.dom.nodeValue=o};return{get:l,getOption:o,set:r}})(e$,"text"),l6=e=>lK.get(e),lJ=(e,t)=>lK.set(e,t);var lQ=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address",];let lX=(e,t,l,o)=>{let r=l[0],n=l.slice(1);return o(e,t,r,n)},lY=(e,t,l)=>l.length>0?lX(e,t,l,lZ):$.none(),lZ=(e,t,l,o)=>{let r=t(e,l);return J(o,(l,o)=>{let r=t(e,o);return l5(e,l,r)},r)},l5=(e,t,l)=>t.bind(t=>l.filter(S(e.eq,t))),oe=lY,ot=(()=>{let e=e=>eu.fromDom(e.dom.cloneNode(!1)),t=e=>!!eT(e)&&("body"===ew(e)||j(lQ,ew(e))),l=e=>!!eT(e)&&j(["br","img","hr","input"],ew(e)),o=e=>eT(e)&&"false"===tn(e,"contenteditable"),r=(e,t)=>e.dom.compareDocumentPosition(t.dom),n=(e,t)=>{let l=ti(e);tr(t,l)},a=e=>{let t=ew(e);return j(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp",],t)},s=e=>eT(e)?ta(e,"lang"):$.none();return{up:f({selector:ez,closest:e1,predicate:eV,all:eD}),down:f({selector:tt,predicate:e5}),styles:f({get:tA,getRaw:t8,set:t_,remove:tO}),attrs:f({get:tn,set:to,remove:ts,copyTo:n}),insert:f({before:lz,after:lW,afterAll:l2,append:l1,appendAll:l3,prepend:lU,wrap:lG}),remove:f({unwrap:l7,remove:l4}),create:f({nu:eu.fromTag,clone:e,text:eu.fromText}),query:f({comparePosition:r,prevSibling:eI,nextSibling:eN}),property:f({children:eM,name:ew,parent:eO,document:e=>e8(e).dom,isText:e$,isComment:ev,isElement:eT,isSpecial:a,getLanguage:s,getText:l6,setText:lJ,isBoundary:t,isEmptyTag:l,isNonEditable:o}),eq:ef,is:ey}})(),ol=(e,t)=>oe(ot,(t,l)=>e(l),t),oo=e=>ez(e,"table"),or=(e,t)=>{let l=tt(e,t);return l.length>0?$.some(l):$.none()},on=(e,t,l)=>eU(e,t).bind(t=>eU(e,l).bind(e=>ol(oo,[t,e]).map(l=>({first:t,last:e,table:l})))),oa=(e,t)=>or(e,t),os=(e,t,l)=>on(e,t,l).bind(t=>{let l=t=>ef(e,t),o="thead,tfoot,tbody,table",r=ez(t.first,o,l),n=ez(t.last,o,l);return r.bind(e=>n.bind(l=>ef(e,l)?l9(t.table,t.first,t.last):$.none()))}),oi=e=>z(e,eu.fromDom),oc="data-mce-selected",om="data-mce-first-selected",od="data-mce-last-selected",ou={selected:oc,selectedSelector:"td["+oc+"],th["+oc+"]",firstSelected:om,firstSelectedSelector:"td["+om+"],th["+om+"]",lastSelected:od,lastSelectedSelector:"td["+od+"],th["+od+"]"},ob=e=>tz(e).bind(e=>oa(e,ou.firstSelectedSelector)).fold(f(e),e=>e[0]),op=e=>(t,l)=>{let o=ew(t),r="col"===o||"colgroup"===o?ob(t):t;return e1(r,e,l)},og=op("th,td,caption"),oh=op("th,td"),of=e=>oi(e.model.table.getSelectedCells()),oy=(e,t)=>{let l=oh(e),o=l.bind(e=>tz(e)).map(e=>tW(e));return td(l,o,(e,l)=>K(l,l=>H(oi(l.dom.cells),l=>"1"===tn(l,t)||ef(l,e)))).getOr([])},ow=[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"},],oS=e=>({value:o$(e)}),oC=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,ov=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,oT=e=>oC.test(e)||ov.test(e),o$=e=>th(e,"#").toUpperCase(),ox=e=>oT(e)?$.some({value:o$(e)}):$.none(),o_=e=>{let t=e.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},oA=e=>{let t=o_(e.red)+o_(e.green)+o_(e.blue);return oS(t)},oR=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,o8=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,oO=(e,t,l,o)=>({red:e,green:t,blue:l,alpha:o}),oD=(e,t,l,o)=>{let r=parseInt(e,10),n=parseInt(t,10),a=parseInt(l,10),s=parseFloat(o);return oO(r,n,a,s)},oI=e=>{if("transparent"===e)return $.some(oO(0,0,0,0));let t=oR.exec(e);if(null!==t)return $.some(oD(t[1],t[2],t[3],"1"));let l=o8.exec(e);return null!==l?$.some(oD(l[1],l[2],l[3],l[4])):$.none()},oN=e=>ox(e).orThunk(()=>oI(e).map(oA)).getOrThunk(()=>{let t=document.createElement("canvas");t.height=1,t.width=1;let l=t.getContext("2d");l.clearRect(0,0,t.width,t.height),l.fillStyle="#FFFFFF",l.fillStyle=e,l.fillRect(0,0,1,1);let o=l.getImageData(0,0,1,1).data,r=o[0],n=o[1],a=o[2],s=o[3];return oA(oO(r,n,a,s))}),oM=e=>oI(e).map(oA).map(e=>"#"+e.value).getOr(e),oP=e=>{let t=e,l=e=>{t=e};return{get:()=>t,set:l}},ok=e=>{let t=oP($.none()),l=()=>t.get().each(e),o=()=>{l(),t.set($.none())},r=()=>t.get().isSome(),n=()=>t.get(),a=e=>{l(),t.set($.some(e))};return{clear:o,isSet:r,get:n,set:a}},oB=()=>ok(e=>e.unbind()),oE=(e,t,l)=>o=>{let r=oB(),n=tS(l),a=()=>{let a=of(e),s=o=>e.formatter.match(t,{value:l},o.dom,n);n?(o.setActive(!H(a,s)),r.set(e.formatter.formatChanged(t,e=>o.setActive(!e),!0))):(o.setActive(et(a,s)),r.set(e.formatter.formatChanged(t,o.setActive,!1,{value:l})))};return e.initialized?a():e.on("init",a),r.clear},oq=e=>B(e,"menu"),oF=e=>z(e,e=>{let t=e.text||e.title||"";return oq(e)?{text:t,items:oF(e.menu)}:{text:t,value:e.value}}),oL=(e,t,l,o)=>z(t,t=>{let r=t.text||t.title;return oq(t)?{type:"nestedmenuitem",text:r,getSubmenuItems:()=>oL(e,t.menu,l,o)}:{text:r,type:"togglemenuitem",onAction:()=>o(t.value),onSetup:oE(e,l,t.value)}}),oj=(e,t)=>l=>{e.execCommand("mceTableApplyCellStyle",!1,{[t]:l})},oH=e=>ee(e,e=>oq(e)?[{...e,menu:oH(e.menu)},]:tw(e.value)?[e]:[]),oV=(e,t,l,o)=>r=>r(oL(e,t,l,o)),o9=(e,t,l)=>{let o=z(t,e=>({text:e.title,value:"#"+oN(e.value).value,type:"choiceitem"}));return[{type:"fancymenuitem",fancytype:"colorswatch",initData:{colors:o.length>0?o:void 0,allowCustomColors:!1},onAction(t){let o="remove"===t.value?"":t.value;e.execCommand("mceTableApplyCellStyle",!1,{[l]:o})}},]},o0=e=>()=>{let t=e.queryCommandValue("mceTableRowType");e.execCommand("mceTableRowType",!1,{type:"header"===t?"body":"header"})},oz=e=>()=>{let t=e.queryCommandValue("mceTableColType");e.execCommand("mceTableColType",!1,{type:"th"===t?"td":"th"})},oW=e=>{let t=oF(lO(e));return t.length>0?$.some({name:"class",type:"listbox",label:"Class",items:t}):$.none()},oU=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"},]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"},]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"},]},{name:"valign",type:"listbox",label:"Vertical align",items:ow},],o1=e=>oU.concat(oW(e).toArray()),oG=(e,t)=>{let l=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""},].concat(oF(lT(e)))},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"},],o="cell"===t?[{name:"borderwidth",type:"input",label:"Border width"}].concat(l):l;return{title:"Advanced",name:"advanced",items:o}},o2=(e,t)=>{let l=e.dom,o=(e,o)=>{l.setAttrib(t,e,o)},r=(e,o)=>{l.setStyle(t,e,o)},n=(l,o)=>{""===o?e.formatter.remove(l,{value:null},t,!0):e.formatter.apply(l,{value:o},t)};return{setAttrib:o,setStyle:r,setFormat:n}},o3={normal:o2},o4=eA("th"),o7=(e,t)=>e&&t?"sectionCells":e?"section":"cells",oK=e=>{let t="thead"===e.section,l=tc(o6(e.cells),"th");return"tfoot"===e.section?{type:"footer"}:t||l?{type:"header",subType:o7(t,l)}:{type:"body"}},o6=e=>{let t=K(e,e=>o4(e.element));return 0===t.length?$.some("td"):t.length===e.length?$.some("th"):$.none()},oJ=e=>{let t=z(e,e=>oK(e).type),l=j(t,"header"),o=j(t,"footer");if(!l&&!o)return $.some("body");{let r=j(t,"body");return!l||r||o?l||r||!o?$.none():$.some("footer"):$.some("header")}},oQ=e=>{let t=!1,l;return(...o)=>(t||(t=!0,l=e.apply(null,o)),l)},oX=(e,t)=>ea(e.all,e=>Y(e.cells,e=>ef(t,e.element))),oY=(e,t,l)=>{let o=z(t.selection,t=>tV(t).bind(t=>oX(e,t)).filter(l)),r=tm(o);return tb(r.length>0,r)},oZ=(e,t)=>t.mergable,o5=(e,t)=>t.unmergable,re=(e,t)=>oY(e,t,T),rt=(e,t)=>oX(e,t).exists(e=>!e.isLocked),rl=(e,t)=>et(t,t=>rt(e,t)),ro=(e,t)=>oZ(e,t).filter(t=>rl(e,t.cells)),rr=(e,t)=>o5(e,t).filter(t=>rl(e,t)),rn=e=>{if(!i(e))throw Error("cases must be an array");if(0===e.length)throw Error("there must be at least one case");let t=[],l={};return W(e,(o,r)=>{let n=x(o);if(1!==n.length)throw Error("one and only one name per case");let a=n[0],s=o[a];if(void 0!==l[a])throw Error("duplicate key detected:"+a);if("cata"===a)throw Error("cannot have a case named cata (sorry)");if(!i(s))throw Error("case arguments must be an array");t.push(a),l[a]=(...l)=>{let o=l.length;if(o!==s.length)throw Error("Wrong number of arguments to case "+a+". Expected "+s.length+" ("+s+"), got "+o);let n=e=>{let o=x(e);if(t.length!==o.length)throw Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+o.join(","));let r=et(t,e=>j(o,e));if(!r)throw Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,l)};return{fold(...t){if(t.length!==e.length)throw Error("Wrong number of arguments to fold. Expected "+e.length+", got "+t.length);let o=t[r];return o.apply(null,l)},match:n,log(e){console.log(e,{constructors:t,constructor:a,params:l})}}}}),l};({generate:rn}).generate([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]},]);let ra=(e,t)=>{let l=le.fromTable(e),o=re(l,t);return o.bind(e=>{let t=e[e.length-1],o=e[0].row,r=t.row+t.rowspan,n=l.all.slice(o,r);return oJ(n)}).getOr("")},rs=ra,ri=e=>tf(e,"rgb")?oM(e):e,rc=e=>{let t=eu.fromDom(e);return{borderwidth:t8(t,"border-width").getOr(""),borderstyle:t8(t,"border-style").getOr(""),bordercolor:t8(t,"border-color").map(ri).getOr(""),backgroundcolor:t8(t,"background-color").map(ri).getOr("")}},rm=e=>{let t=e[0],l=e.slice(1);return W(l,e=>{W(x(t),l=>{A(e,(e,o)=>{let r=t[l];""!==r&&l===o&&r!==e&&(t[l]="")})})}),t},rd=(e,t,l,o)=>Y(e,e=>!m(l.formatter.matchNode(o,t+e))).getOr(""),ru=S(rd,["left","center","right"],"align"),rb=S(rd,["top","middle","bottom"],"valign"),rp=(e,t)=>{let l=lE(e),o=lq(e),r=t?{borderstyle:P(l,"border-style").getOr(""),bordercolor:ri(P(l,"border-color").getOr("")),backgroundcolor:ri(P(l,"background-color").getOr(""))}:{},n={height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:0,...l,...o,...r,...(()=>{let t=l["border-width"];return l8(e)&&t?{border:t}:P(o,"border").fold(()=>({}),e=>({border:e}))})(),...(()=>{let e=P(l,"border-spacing").or(P(o,"cellspacing")).fold(()=>({}),e=>({cellspacing:e})),t=P(l,"border-padding").or(P(o,"cellpadding")).fold(()=>({}),e=>({cellpadding:e}));return{...e,...t}})()};return n},rg=e=>tz(eu.fromDom(e)).map(t=>{let l={selection:oi(e.cells)};return rs(t,l)}).getOr(""),rh=(e,t,l)=>{let o=e.dom,r=l8(e)?o.getStyle(t,"border-spacing")||o.getAttrib(t,"cellspacing"):o.getAttrib(t,"cellspacing")||o.getStyle(t,"border-spacing"),n=l8(e)?ll(o,t,"padding")||o.getAttrib(t,"cellpadding"):o.getAttrib(t,"cellpadding")||ll(o,t,"padding");return{width:o.getStyle(t,"width")||o.getAttrib(t,"width"),height:o.getStyle(t,"height")||o.getAttrib(t,"height"),cellspacing:null!=r?r:"",cellpadding:null!=n?n:"",border:((t,l)=>{let o=t8(eu.fromDom(l),"border-width");return l8(e)&&o.isSome()?o.getOr(""):t.getAttrib(l,"border")||ll(e.dom,l,"border-width")||ll(e.dom,l,"border")||""})(o,t),caption:!!o.select("caption",t)[0],class:o.getAttrib(t,"class",""),align:ru(e,t),...l?rc(t):{}}},rf=(e,t,l)=>{let o=e.dom;return{height:o.getStyle(t,"height")||o.getAttrib(t,"height"),class:o.getAttrib(t,"class",""),type:rg(t),align:ru(e,t),...l?rc(t):{}}},ry=(e,t,l,o)=>{let r=e.dom,n=o.getOr(t),a=(e,t)=>r.getStyle(e,t)||r.getAttrib(e,t);return{width:a(n,"width"),height:a(t,"height"),scope:r.getAttrib(t,"scope"),celltype:e4(t),class:r.getAttrib(t,"class",""),halign:ru(e,t),valign:rb(e,t),...l?rc(t):{}}},rw=(e,t)=>{let l=le.fromTable(e),o=le.justCells(l),r=K(o,e=>H(t,t=>ef(e.element,t)));return z(r,e=>({element:e.element.dom,column:le.getColumnAt(l,e.column).map(e=>e.element.dom)}))},rS=(e,t,l,o)=>{o("scope")&&e.setAttrib("scope",l.scope),o("class")&&e.setAttrib("class",l.class),o("height")&&e.setStyle("height",eJ(l.height)),o("width")&&t.setStyle("width",eJ(l.width))},rC=(e,t,l)=>{l("backgroundcolor")&&e.setFormat("tablecellbackgroundcolor",t.backgroundcolor),l("bordercolor")&&e.setFormat("tablecellbordercolor",t.bordercolor),l("borderstyle")&&e.setFormat("tablecellborderstyle",t.borderstyle),l("borderwidth")&&e.setFormat("tablecellborderwidth",eJ(t.borderwidth))},rv=(e,t,l,o)=>{let r=1===t.length;W(t,t=>{let n=t.element,a=r?T:o,s=o3.normal(e,n),i=t.column.map(t=>o3.normal(e,t)).getOr(s);rS(s,i,l,a),l$(e)&&rC(s,l,a),o("halign")&&lo(e,n,l.halign),o("valign")&&lr(e,n,l.valign)})},rT=(e,t)=>{e.execCommand("mceTableCellType",!1,{type:t.celltype,no_events:!0})},r$=(e,t,l,o)=>{let r=D(o,(e,t)=>l[t]!==e);M(r)>0&&t.length>=1&&tz(t[0]).each(l=>{let n=rw(l,t),a=M(D(r,(e,t)=>"scope"!==t&&"celltype"!==t))>0,s=k(r,"celltype");(a||k(r,"scope"))&&rv(e,n,o,S(k,r)),s&&rT(e,o),ln(e,l.dom,{structure:s,style:a})})},rx=(e,t,l,o)=>{let r=o.getData();o.close(),e.undoManager.transact(()=>{r$(e,t,l,r),e.focus()})},r_=(e,t)=>{let l=tz(t[0]).map(l=>z(rw(l,t),t=>ry(e,t.element,l$(e),t.column)));return rm(l.getOrDie())},rA=e=>{let t=of(e);if(0===t.length)return;let l=r_(e,t),o={type:"tabpanel",tabs:[{title:"General",name:"general",items:o1(e)},oG(e,"cell"),]},r={type:"panel",items:[{type:"grid",columns:2,items:o1(e)},]};e.windowManager.open({title:"Cell Properties",size:"normal",body:l$(e)?o:r,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0},],initialData:l,onSubmit:S(rx,e,t,l)})},rR=e=>{let t=oF(lD(e));return t.length>0?$.some({name:"class",type:"listbox",label:"Class",items:t}):$.none()},r8=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"},]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"},]},{label:"Height",name:"height",type:"input"},],rO=e=>r8.concat(rR(e).toArray()),rD=(e,t,l)=>{l("class")&&e.setAttrib("class",t.class),l("height")&&e.setStyle("height",eJ(t.height))},rI=(e,t,l)=>{l("backgroundcolor")&&e.setStyle("background-color",t.backgroundcolor),l("bordercolor")&&e.setStyle("border-color",t.bordercolor),l("borderstyle")&&e.setStyle("border-style",t.borderstyle)},rN=(e,t,l,o)=>{let r=1===t.length,n=r?T:o;W(t,t=>{let r=o3.normal(e,t);rD(r,l,n),lx(e)&&rI(r,l,n),o("align")&&lo(e,t,l.align)})},rM=(e,t)=>{e.execCommand("mceTableRowType",!1,{type:t.type,no_events:!0})},rP=(e,t,l,o)=>{let r=D(o,(e,t)=>l[t]!==e);if(M(r)>0){let n=k(r,"type"),a=!n||M(r)>1;a&&rN(e,t,o,S(k,r)),n&&rM(e,o),tz(eu.fromDom(t[0])).each(t=>ln(e,t.dom,{structure:n,style:a}))}},rk=(e,t,l,o)=>{let r=o.getData();o.close(),e.undoManager.transact(()=>{rP(e,t,l,r),e.focus()})},rB=e=>{let t=oy(eQ(e),ou.selected);if(0===t.length)return;let l=z(t,t=>rf(e,t.dom,lx(e))),o=rm(l),r={type:"tabpanel",tabs:[{title:"General",name:"general",items:rO(e)},oG(e,"row"),]},n={type:"panel",items:[{type:"grid",columns:2,items:rO(e)},]};e.windowManager.open({title:"Row Properties",size:"normal",body:lx(e)?r:n,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0},],initialData:o,onSubmit:S(rk,e,z(t,e=>e.dom),o)})},rE=(e,t,l)=>{let o=lA(e)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"},]},]:[],r=t.length>0?[{type:"listbox",name:"class",label:"Class",items:t},]:[];return(l?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"},]:[]).concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"},]).concat(o).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"},]},]).concat(r)},rq=(e,t,l,o)=>{if("TD"===t.tagName||"TH"===t.tagName)s(l)&&u(o)?e.setStyle(t,l,o):e.setStyles(t,l);else if(t.children)for(let r=0;r<t.children.length;r++)rq(e,t.children[r],l,o)},rF=(e,t,l,o)=>{let r=e.dom,n={},a={},s=l8(e),i=l_(e);if(m(l.class)||(n.class=l.class),a.height=eJ(l.height),s?a.width=eJ(l.width):r.getAttrib(t,"width")&&(n.width=e6(l.width)),s&&l.border>0?(a["border-width"]=eJ(l.border),a["border-spacing"]=eJ(l.cellspacing)):(n.border=l.border,n.cellpadding=l.cellpadding,n.cellspacing=l.cellspacing),s&&t.children){let c={};if(o.border&&l.border>0&&(c["border-width"]=eJ(l.border)),o.cellpadding&&(c.padding=eJ(l.cellpadding)),i&&o.bordercolor&&(c["border-color"]=l.bordercolor),!E(c))for(let d=0;d<t.children.length;d++)rq(r,t.children[d],c);if(0==l.border)for(let u=0;u<t.children.length;u++)rq(r,t.children[u],"border-width","")}if(i){let b=l;a["background-color"]=b.backgroundcolor,a["border-color"]=b.bordercolor,a["border-style"]=b.borderstyle}n.style=r.serializeStyle({...lE(e),...a}),r.setAttribs(t,{...lq(e),...n})},rL=(e,t,l,o)=>{let r=e.dom,n=o.getData(),a=D(n,(e,t)=>l[t]!==e);o.close(),""===n.class&&delete n.class,e.undoManager.transact(()=>{if(!t){let l=tC(n.cols).getOr(1),o=tC(n.rows).getOr(1);e.execCommand("mceInsertTable",!1,{rows:o,columns:l}),t=oh(eQ(e),eK(e)).bind(t=>tz(t,eK(e))).map(e=>e.dom).getOrDie()}if(M(a)>0){let s={border:k(a,"border"),bordercolor:k(a,"bordercolor"),cellpadding:k(a,"cellpadding")};rF(e,t,n,s);let i=r.select("caption",t)[0];(i&&!n.caption||!i&&n.caption)&&e.execCommand("mceTableToggleCaption"),lo(e,t,n.align)}if(e.focus(),e.addVisual(),M(a)>0){let c=k(a,"caption"),m=!c||M(a)>1;ln(e,t,{structure:c,style:m})}})},rj=(e,t)=>{let l=e.dom,o,r=rp(e,l_(e));t?(r.cols="1",r.rows="1",l_(e)&&(r.borderstyle="",r.bordercolor="",r.backgroundcolor="")):(o=l.getParent(e.selection.getStart(),"table",e.getBody()))?r=rh(e,o,l_(e)):l_(e)&&(r.borderstyle="",r.bordercolor="",r.backgroundcolor="");let n=oF(lI(e));n.length>0&&r.class&&(r.class=r.class.replace(/\s*mce\-item\-table\s*/g,""));let a={type:"grid",columns:2,items:rE(e,n,t)},s=l_(e)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[a]},oG(e,"table"),]}:{type:"panel",items:[a]};e.windowManager.open({title:"Table Properties",size:"normal",body:s,onSubmit:S(rL,e,o,r),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0},],initialData:r})},rH=e=>{let t=t=>{eY(eQ(e))&&t()};A({mceTableProps:S(rj,e,!1),mceTableRowProps:S(rB,e),mceTableCellProps:S(rA,e),mceInsertTableDialog:S(rj,e,!0)},(l,o)=>e.addCommand(o,()=>t(l)))},rV=(e,t)=>eW(e,t).isSome(),r9=y,r0=e=>{let t=(e,t)=>ta(e,t).exists(e=>parseInt(e,10)>1),l=e=>t(e,"rowspan")||t(e,"colspan");return e.length>0&&et(e,l)?$.some(e):$.none()},rz=(e,t,l)=>t.length<=1?$.none():os(e,l.firstSelectedSelector,l.lastSelectedSelector).map(e=>({bounds:e,cells:t})),rW=e=>({element:e,mergable:$.none(),unmergable:$.none(),selection:[e]}),rU=(e,t,l)=>({element:l,mergable:rz(t,e,ou),unmergable:r0(e),selection:r9(e)}),r1=e=>{let t=oP($.none()),l=oP([]),o=$.none(),r=eA("caption"),n=e=>o.forall(t=>!t[e]),a=()=>og(eQ(e),eK(e)),s=()=>og(eX(e),eK(e)),i=()=>a().bind(t=>tu(td(tz(t),s().bind(tz),(l,o)=>ef(l,o)?r(t)?$.some(rW(t)):$.some(rU(of(e),l,t)):$.none()))),c=e=>{let t=tz(e.element);return t.map(t=>{let l=le.fromTable(t),o=re(l,e).getOr([]),r=Q(o,(e,t)=>(t.isLocked&&(e.onAny=!0,0===t.column?e.onFirst=!0:t.column+t.colspan>=l.grid.columns&&(e.onLast=!0)),e),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:ro(l,e).isSome(),unmergeable:rr(l,e).isSome(),locked:r}})},m=()=>{t.set(oQ(i)()),o=t.get().bind(c),W(l.get(),C)},d=e=>(e(),l.set(l.get().concat([e])),()=>{l.set(K(l.get(),t=>t!==e))}),u=(l,o)=>d(()=>t.get().fold(()=>{l.setEnabled(!1)},t=>{l.setEnabled(!o(t)&&e.selection.isEditable())})),b=(l,o,r)=>d(()=>t.get().fold(()=>{l.setEnabled(!1),l.setActive(!1)},t=>{l.setEnabled(!o(t)&&e.selection.isEditable()),l.setActive(r(t))})),p=e=>o.exists(t=>t.locked[e]),g=e=>u(e,e=>!1),h=e=>u(e,e=>r(e.element)),f=e=>t=>u(t,t=>r(t.element)||p(e)),y=e=>t=>u(t,t=>r(t.element)||e().isNone()),w=(e,t)=>l=>u(l,l=>r(l.element)||e().isNone()||p(t)),S=e=>u(e,e=>n("mergeable")),T=e=>u(e,e=>n("unmergeable")),x=t=>b(t,v,t=>{let l=tz(t.element,eK(e));return l.exists(e=>rV(e,"caption"))}),_=(t,l)=>o=>b(o,e=>r(e.element),()=>e.queryCommandValue(t)===l),A=_("mceTableRowType","header"),R=_("mceTableColType","th");return e.on("NodeChange ExecCommand TableSelectorChange",m),{onSetupTable:g,onSetupCellOrRow:h,onSetupColumn:f,onSetupPasteable:y,onSetupPasteableColumn:w,onSetupMergeable:S,onSetupUnmergeable:T,resetTargets:m,onSetupTableWithCaption:x,onSetupTableRowHeaders:A,onSetupTableColumnHeaders:R,targets:t.get}};var rG=tinymce.util.Tools.resolve("tinymce.FakeClipboard");let r2="x-tinymce/dom-table-",r3=r2+"rows",r4=r2+"columns",r7=e=>{var t;let l=null!==(t=rG.read())&&void 0!==t?t:[];return ea(l,t=>$.from(t.getType(e)))},rK=()=>r7(r3),r6=()=>r7(r4),rJ=e=>t=>{let l=()=>{t.setEnabled(e.selection.isEditable())};return e.on("NodeChange",l),l(),()=>{e.off("NodeChange",l)}},rQ=(e,t)=>{e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",onSetup:rJ(e),fetch:e=>e("inserttable | cell row column | advtablesort | tableprops deletetable")});let l=t=>()=>e.execCommand(t),o=(t,o)=>{e.queryCommandSupported(o.command)&&e.ui.registry.addButton(t,{...o,onAction:b(o.onAction)?o.onAction:l(o.command)})},r=(t,o)=>{e.queryCommandSupported(o.command)&&e.ui.registry.addToggleButton(t,{...o,onAction:b(o.onAction)?o.onAction:l(o.command)})};o("tableprops",{tooltip:"Table properties",command:"mceTableProps",icon:"table",onSetup:t.onSetupTable}),o("tabledelete",{tooltip:"Delete table",command:"mceTableDelete",icon:"table-delete-table",onSetup:t.onSetupTable}),o("tablecellprops",{tooltip:"Cell properties",command:"mceTableCellProps",icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),o("tablemergecells",{tooltip:"Merge cells",command:"mceTableMergeCells",icon:"table-merge-cells",onSetup:t.onSetupMergeable}),o("tablesplitcells",{tooltip:"Split cell",command:"mceTableSplitCells",icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),o("tableinsertrowbefore",{tooltip:"Insert row before",command:"mceTableInsertRowBefore",icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),o("tableinsertrowafter",{tooltip:"Insert row after",command:"mceTableInsertRowAfter",icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),o("tabledeleterow",{tooltip:"Delete row",command:"mceTableDeleteRow",icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),o("tablerowprops",{tooltip:"Row properties",command:"mceTableRowProps",icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),o("tableinsertcolbefore",{tooltip:"Insert column before",command:"mceTableInsertColBefore",icon:"table-insert-column-before",onSetup:t.onSetupColumn("onFirst")}),o("tableinsertcolafter",{tooltip:"Insert column after",command:"mceTableInsertColAfter",icon:"table-insert-column-after",onSetup:t.onSetupColumn("onLast")}),o("tabledeletecol",{tooltip:"Delete column",command:"mceTableDeleteCol",icon:"table-delete-column",onSetup:t.onSetupColumn("onAny")}),o("tablecutrow",{tooltip:"Cut row",command:"mceTableCutRow",icon:"cut-row",onSetup:t.onSetupCellOrRow}),o("tablecopyrow",{tooltip:"Copy row",command:"mceTableCopyRow",icon:"duplicate-row",onSetup:t.onSetupCellOrRow}),o("tablepasterowbefore",{tooltip:"Paste row before",command:"mceTablePasteRowBefore",icon:"paste-row-before",onSetup:t.onSetupPasteable(rK)}),o("tablepasterowafter",{tooltip:"Paste row after",command:"mceTablePasteRowAfter",icon:"paste-row-after",onSetup:t.onSetupPasteable(rK)}),o("tablecutcol",{tooltip:"Cut column",command:"mceTableCutCol",icon:"cut-column",onSetup:t.onSetupColumn("onAny")}),o("tablecopycol",{tooltip:"Copy column",command:"mceTableCopyCol",icon:"duplicate-column",onSetup:t.onSetupColumn("onAny")}),o("tablepastecolbefore",{tooltip:"Paste column before",command:"mceTablePasteColBefore",icon:"paste-column-before",onSetup:t.onSetupPasteableColumn(r6,"onFirst")}),o("tablepastecolafter",{tooltip:"Paste column after",command:"mceTablePasteColAfter",icon:"paste-column-after",onSetup:t.onSetupPasteableColumn(r6,"onLast")}),o("tableinsertdialog",{tooltip:"Insert table",command:"mceInsertTableDialog",icon:"table",onSetup:rJ(e)});let n=oH(lI(e));0!==n.length&&e.queryCommandSupported("mceTableToggleClass")&&e.ui.registry.addMenuButton("tableclass",{icon:"table-classes",tooltip:"Table styles",fetch:oV(e,n,"tableclass",t=>e.execCommand("mceTableToggleClass",!1,t)),onSetup:t.onSetupTable});let a=oH(lO(e));0!==a.length&&e.queryCommandSupported("mceTableCellToggleClass")&&e.ui.registry.addMenuButton("tablecellclass",{icon:"table-cell-classes",tooltip:"Cell styles",fetch:oV(e,a,"tablecellclass",t=>e.execCommand("mceTableCellToggleClass",!1,t)),onSetup:t.onSetupCellOrRow}),e.queryCommandSupported("mceTableApplyCellStyle")&&(e.ui.registry.addMenuButton("tablecellvalign",{icon:"vertical-align",tooltip:"Vertical align",fetch:oV(e,ow,"tablecellverticalalign",oj(e,"vertical-align")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderwidth",{icon:"border-width",tooltip:"Border width",fetch:oV(e,lv(e),"tablecellborderwidth",oj(e,"border-width")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellborderstyle",{icon:"border-style",tooltip:"Border style",fetch:oV(e,lT(e),"tablecellborderstyle",oj(e,"border-style")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbackgroundcolor",{icon:"cell-background-color",tooltip:"Background color",fetch:t=>t(o9(e,lM(e),"background-color")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellbordercolor",{icon:"cell-border-color",tooltip:"Border color",fetch:t=>t(o9(e,lP(e),"border-color")),onSetup:t.onSetupCellOrRow})),r("tablecaption",{tooltip:"Table caption",icon:"table-caption",command:"mceTableToggleCaption",onSetup:t.onSetupTableWithCaption}),r("tablerowheader",{tooltip:"Row header",icon:"table-top-header",command:"mceTableRowType",onAction:o0(e),onSetup:t.onSetupTableRowHeaders}),r("tablecolheader",{tooltip:"Column header",icon:"table-left-header",command:"mceTableColType",onAction:oz(e),onSetup:t.onSetupTableColumnHeaders})},rX=e=>{let t=t=>e.dom.is(t,"table")&&e.getBody().contains(t)&&e.dom.isEditable(t.parentNode),l=lN(e);l.length>0&&e.ui.registry.addContextToolbar("table",{predicate:t,items:l,scope:"node",position:"node"})},rY=e=>t=>{let l=()=>{t.setEnabled(e.selection.isEditable())};return e.on("NodeChange",l),l(),()=>{e.off("NodeChange",l)}},rZ=(e,t)=>{let l=t=>()=>e.execCommand(t),o=(t,o)=>!!e.queryCommandSupported(o.command)&&(e.ui.registry.addMenuItem(t,{...o,onAction:b(o.onAction)?o.onAction:l(o.command)}),!0),r=(t,o)=>{e.queryCommandSupported(o.command)&&e.ui.registry.addToggleMenuItem(t,{...o,onAction:b(o.onAction)?o.onAction:l(o.command)})},n=t=>{e.execCommand("mceInsertTable",!1,{rows:t.numRows,columns:t.numColumns})},a=[o("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",command:"mceTableInsertRowBefore",onSetup:t.onSetupCellOrRow}),o("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",command:"mceTableInsertRowAfter",onSetup:t.onSetupCellOrRow}),o("tabledeleterow",{text:"Delete row",icon:"table-delete-row",command:"mceTableDeleteRow",onSetup:t.onSetupCellOrRow}),o("tablerowprops",{text:"Row properties",icon:"table-row-properties",command:"mceTableRowProps",onSetup:t.onSetupCellOrRow}),o("tablecutrow",{text:"Cut row",icon:"cut-row",command:"mceTableCutRow",onSetup:t.onSetupCellOrRow}),o("tablecopyrow",{text:"Copy row",icon:"duplicate-row",command:"mceTableCopyRow",onSetup:t.onSetupCellOrRow}),o("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",command:"mceTablePasteRowBefore",onSetup:t.onSetupPasteable(rK)}),o("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",command:"mceTablePasteRowAfter",onSetup:t.onSetupPasteable(rK)}),],s=[o("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",command:"mceTableInsertColBefore",onSetup:t.onSetupColumn("onFirst")}),o("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",command:"mceTableInsertColAfter",onSetup:t.onSetupColumn("onLast")}),o("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",command:"mceTableDeleteCol",onSetup:t.onSetupColumn("onAny")}),o("tablecutcolumn",{text:"Cut column",icon:"cut-column",command:"mceTableCutCol",onSetup:t.onSetupColumn("onAny")}),o("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",command:"mceTableCopyCol",onSetup:t.onSetupColumn("onAny")}),o("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",command:"mceTablePasteColBefore",onSetup:t.onSetupPasteableColumn(r6,"onFirst")}),o("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",command:"mceTablePasteColAfter",onSetup:t.onSetupPasteableColumn(r6,"onLast")}),],i=[o("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",command:"mceTableCellProps",onSetup:t.onSetupCellOrRow}),o("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",command:"mceTableMergeCells",onSetup:t.onSetupMergeable}),o("tablesplitcells",{text:"Split cell",icon:"table-split-cells",command:"mceTableSplitCells",onSetup:t.onSetupUnmergeable}),];lR(e)?e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"inserttable",onAction:n},],onSetup:rY(e)}):e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:l("mceInsertTableDialog"),onSetup:rY(e)}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:l("mceInsertTableDialog"),onSetup:rY(e)}),o("tableprops",{text:"Table properties",onSetup:t.onSetupTable,command:"mceTableProps"}),o("deletetable",{text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,command:"mceTableDelete"}),j(a,!0)&&e.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:f("tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter")}),j(s,!0)&&e.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:f("tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter")}),j(i,!0)&&e.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:f("tablecellprops tablemergecells tablesplitcells")}),e.ui.registry.addContextMenu("table",{update:()=>(t.resetTargets(),t.targets().fold(f(""),e=>"caption"===ew(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"))});let c=oH(lI(e));0!==c.length&&e.queryCommandSupported("mceTableToggleClass")&&e.ui.registry.addNestedMenuItem("tableclass",{icon:"table-classes",text:"Table styles",getSubmenuItems:()=>oL(e,c,"tableclass",t=>e.execCommand("mceTableToggleClass",!1,t)),onSetup:t.onSetupTable});let m=oH(lO(e));0!==m.length&&e.queryCommandSupported("mceTableCellToggleClass")&&e.ui.registry.addNestedMenuItem("tablecellclass",{icon:"table-cell-classes",text:"Cell styles",getSubmenuItems:()=>oL(e,m,"tablecellclass",t=>e.execCommand("mceTableCellToggleClass",!1,t)),onSetup:t.onSetupCellOrRow}),e.queryCommandSupported("mceTableApplyCellStyle")&&(e.ui.registry.addNestedMenuItem("tablecellvalign",{icon:"vertical-align",text:"Vertical align",getSubmenuItems:()=>oL(e,ow,"tablecellverticalalign",oj(e,"vertical-align")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderwidth",{icon:"border-width",text:"Border width",getSubmenuItems:()=>oL(e,lv(e),"tablecellborderwidth",oj(e,"border-width")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellborderstyle",{icon:"border-style",text:"Border style",getSubmenuItems:()=>oL(e,lT(e),"tablecellborderstyle",oj(e,"border-style")),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbackgroundcolor",{icon:"cell-background-color",text:"Background color",getSubmenuItems:()=>o9(e,lM(e),"background-color"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellbordercolor",{icon:"cell-border-color",text:"Border color",getSubmenuItems:()=>o9(e,lP(e),"border-color"),onSetup:t.onSetupCellOrRow})),r("tablecaption",{icon:"table-caption",text:"Table caption",command:"mceTableToggleCaption",onSetup:t.onSetupTableWithCaption}),r("tablerowheader",{text:"Row header",icon:"table-top-header",command:"mceTableRowType",onAction:o0(e),onSetup:t.onSetupTableRowHeaders}),r("tablecolheader",{text:"Column header",icon:"table-left-header",command:"mceTableColType",onAction:oz(e),onSetup:t.onSetupTableRowHeaders})},r5=e=>{let t=r1(e);lS(e),rH(e),rZ(e,t),rQ(e,t),rX(e)};l.add("table",r5)}();